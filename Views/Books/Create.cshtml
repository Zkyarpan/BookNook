@model BookNook.Models.BookViewModel

@{
    ViewData["Title"] = "Create Book";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container mx-auto px-4 py-6">
    <h2 class="text-3xl font-merriweather text-[#4b2e83] text-center mb-8">Create a New Book</h2>

    @* Success / Error Messages *@
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-100 text-green-700 p-4 rounded mb-6 text-center">
            @TempData["SuccessMessage"]
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="bg-red-100 text-red-700 p-4 rounded mb-6 text-center">
            @TempData["ErrorMessage"]
        </div>
    }

    <div class="bg-white rounded-2xl shadow-lg p-8 max-w-4xl mx-auto font-inter">
        <form asp-action="Create" asp-controller="Books" method="post" enctype="multipart/form-data">
            <div asp-validation-summary="ModelOnly" class="text-red-600 text-sm mb-8 bg-red-50 p-4 rounded-lg"></div>

            <!-- Book Details -->
            <section class="mb-10">
                <h3 class="text-xl font-merriweather text-[#fbbf24] mb-4">Book Details</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label asp-for="Title" class="block text-gray-700 font-medium mb-1">Title</label>
                        <input asp-for="Title"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="Enter book title" />
                        <span asp-validation-for="Title" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Author" class="block text-gray-700 font-medium mb-1">Author</label>
                        <input asp-for="Author"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="Enter author name" />
                        <span asp-validation-for="Author" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Genre" class="block text-gray-700 font-medium mb-1">Genre</label>
                        <input asp-for="Genre"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="e.g., Fiction" />
                        <span asp-validation-for="Genre" class="text-red-600 text-sm"></span>
                    </div>
                    <div class="md:col-span-2">
                        <label asp-for="Description" class="block text-gray-700 font-medium mb-1">Description</label>
                        <textarea asp-for="Description" rows="4"
                                  class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                                  placeholder="Enter book description"></textarea>
                        <span asp-validation-for="Description" class="text-red-600 text-sm"></span>
                    </div>
                </div>
            </section>

            <!-- Pricing & Stock -->
            <section class="mb-10">
                <h3 class="text-xl font-merriweather text-[#fbbf24] mb-4">Pricing & Stock</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label asp-for="Price" class="block text-gray-700 font-medium mb-1">Price</label>
                        <input asp-for="Price" type="number" step="0.01"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="e.g., 10.99" />
                        <span asp-validation-for="Price" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Quantity" class="block text-gray-700 font-medium mb-1">Quantity</label>
                        <input asp-for="Quantity" type="number"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="e.g., 5" />
                        <span asp-validation-for="Quantity" class="text-red-600 text-sm"></span>
                    </div>
                </div>
            </section>

            <!-- Metadata -->
            <section class="mb-10">
                <h3 class="text-xl font-merriweather text-[#fbbf24] mb-4">Metadata</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label asp-for="ISBN" class="block text-gray-700 font-medium mb-1">ISBN</label>
                        <input asp-for="ISBN"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="978-3-16-148410-0" />
                        <span asp-validation-for="ISBN" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Language" class="block text-gray-700 font-medium mb-1">Language</label>
                        <input asp-for="Language"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="e.g., English" />
                        <span asp-validation-for="Language" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Format" class="block text-gray-700 font-medium mb-1">Format</label>
                        <select asp-for="Format"
                                class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]">
                            <option value="">Select format…</option>
                            <option value="paperback">Paperback</option>
                            <option value="hardcover">Hardcover</option>
                            <option value="signed">Signed Edition</option>
                            <option value="limited">Limited Edition</option>
                            <option value="first">First Edition</option>
                            <option value="collectors">Collector’s Edition</option>
                            <option value="authors">Author’s Edition</option>
                            <option value="deluxe">Deluxe Edition</option>
                        </select>
                        <span asp-validation-for="Format" class="text-red-600 text-sm"></span>
                    </div>
                    <div>
                        <label asp-for="Publisher" class="block text-gray-700 font-medium mb-1">Publisher</label>
                        <input asp-for="Publisher"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]"
                               placeholder="Enter publisher" />
                        <span asp-validation-for="Publisher" class="text-red-600 text-sm"></span>
                    </div>
                </div>
            </section>

            <!-- Media -->
            <section class="mb-10">
                <h3 class="text-xl font-merriweather text-[#fbbf24] mb-4">Cover Image</h3>
                <div>
                    <label asp-for="CoverImage" class="block text-gray-700 font-medium mb-1">Upload Cover</label>
                    <input asp-for="CoverImage" type="file"
                           class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]" />
                    <span asp-validation-for="CoverImage" class="text-red-600 text-sm"></span>
                </div>
            </section>

            <!-- Attributes -->
            <section class="mb-10">
                <h3 class="text-xl font-merriweather text-[#fbbf24] mb-4">Attributes</h3>
                <div class="flex flex-wrap gap-8 items-center">
                    <div class="flex items-center">
                        <input asp-for="IsPhysicalLibraryAccess" type="checkbox"
                               class="h-4 w-4 text-[#4b2e83] focus:ring-[#4b2e83] border-gray-300 rounded" />
                        <label asp-for="IsPhysicalLibraryAccess" class="ml-2 text-gray-700">Library Access</label>
                    </div>
                    <div class="flex items-center">
                        <input asp-for="IsBestseller" type="checkbox"
                               class="h-4 w-4 text-[#4b2e83] focus:ring-[#4b2e83] border-gray-300 rounded" />
                        <label asp-for="IsBestseller" class="ml-2 text-gray-700">Bestseller</label>
                    </div>
                    <div class="flex items-center">
                        <input asp-for="IsAwardWinner" type="checkbox"
                               class="h-4 w-4 text-[#4b2e83] focus:ring-[#4b2e83] border-gray-300 rounded" />
                        <label asp-for="IsAwardWinner" class="ml-2 text-gray-700">Award Winner</label>
                    </div>
                    <div class="flex items-center">
                        <input asp-for="IsComingSoon" type="checkbox" id="IsComingSoon"
                               class="h-4 w-4 text-[#4b2e83] focus:ring-[#4b2e83] border-gray-300 rounded" />
                        <label asp-for="IsComingSoon" class="ml-2 text-gray-700">Coming Soon?</label>
                    </div>

                    <div id="releaseDateWrapper" class="mt-4 hidden w-full">
                        <label asp-for="ReleaseDate" class="block text-gray-700 font-medium mb-1">Expected Release</label>
                        <input asp-for="ReleaseDate" type="date"
                               class="w-full p-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-[#4b2e83]" />
                        <span asp-validation-for="ReleaseDate" class="text-red-600 text-sm"></span>
                    </div>
                </div>
            </section>

            <!-- Actions -->
            <div class="text-right">
                <a asp-action="Index" asp-controller="Books"
                   class="inline-block bg-gray-500 text-white py-2 px-6 rounded-lg hover:bg-gray-600 mr-4">
                    Cancel
                </a>
                <button type="submit"
                        class="inline-block bg-[#4b2e83] text-white py-2 px-6 rounded-lg hover:bg-[#3c226a] transition">
                    Create Book
                </button>
            </div>
        </form>
    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
        const chk = document.getElementById('IsComingSoon');
        const wrapper = document.getElementById('releaseDateWrapper');

        chk.addEventListener('change', () => {
            wrapper.classList.toggle('hidden', !chk.checked);
        });

        // on-load (validation)
        if (chk.checked) {
            wrapper.classList.remove('hidden');
        }
    </script>
}
